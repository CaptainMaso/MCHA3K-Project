<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%                                                                          %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%           Generated by MATLAB 9.0 and Fixed-Point Designer 5.2           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%                                                                          %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">Theta</span>, <span class="var type1" id="S3T1U4">dTheta</span>, <span class="var type1" id="S4T2U5">Bias</span>, <span class="var type1" id="S5T3U6">P</span>] = IMUKalmanFilter_fixpt(<span class="var type1" id="S6T1U9">Theta_1</span>, <span class="var type1" id="S7T1U10">dTheta_1</span>, <span class="var type1" id="S8T2U11">Bias_1</span>, <span class="var type1" id="S9T3U12">P_1</span>, <span class="var type1" id="S10T1U13">Gyro</span>, <span class="var type1" id="S11T1U14">AccTheta</span>, <span class="var type1" id="S12T4U15">qw</span>, <span class="var type1" id="S13T5U16">qb</span>, <span class="var type1" id="S14T5U17">rw</span>, <span class="var type1" id="S15T6U18">rt</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="mxinfo " id="T7:U15"><span class="var type1" id="S16T7U21">fm</span> = <span class="mxinfo " id="T7:U17"><span class="fcn" id="F2N10:B23">get_fimath</span>()</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="mxinfo " id="T2:U18"><span class="var type1" id="S4T2U26">Bias</span> = <span class="mxinfo " id="T2:U20">fi(<span class="var type1" id="S8T2U29">Bias_1</span>, 1, 16, 2, <span class="var type1" id="S16T7U33">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    <span class="mxinfo " id="T3:U23"><span class="var type1" id="S5T3U36">P</span> = <span class="mxinfo " id="T3:U25">fi(<span class="var type1" id="S9T3U39">P_1</span>, 1, 32, 4, <span class="var type1" id="S16T7U43">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T1:U28"><span class="var type1" id="S2T1U46">Theta</span> = <span class="mxinfo " id="T1:U30">fi(<span class="var type1" id="S6T1U49">Theta_1</span>, 1, 16, 0, <span class="var type1" id="S16T7U53">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T1:U33"><span class="var type1" id="S3T1U56">dTheta</span> = <span class="mxinfo " id="T1:U35">fi(<span class="var type1" id="S7T1U59">dTheta_1</span>, 1, 16, 0, <span class="var type1" id="S16T7U63">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    [<span class="var type1" id="S19T8U67">fmo_1</span>, <span class="var type1" id="S20T8U68">fmo_2</span>, <span class="var type1" id="S21T9U69">fmo_3</span>, <span class="var type1" id="S22T10U70">fmo_4</span>] = <span class="fcn" id="F327N5:B72">TimeUpdate</span>(<span class="var type1" id="S2T1U73">Theta</span>, <span class="var type1" id="S3T1U74">dTheta</span>, <span class="var type1" id="S4T2U75">Bias</span>, <span class="var type1" id="S5T3U76">P</span>, <span class="var type1" id="S12T4U77">qw</span>, <span class="var type1" id="S13T5U78">qb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="mxinfo " id="T1:U48"><span class="var type1" id="S2T1U81">Theta</span> = <span class="mxinfo " id="T1:U50">fi(<span class="var type1" id="S19T8U84">fmo_1</span>, 1, 16, 0, <span class="var type1" id="S16T7U88">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">    <span class="mxinfo " id="T1:U53"><span class="var type1" id="S3T1U91">dTheta</span> = <span class="mxinfo " id="T1:U55">fi(<span class="var type1" id="S20T8U94">fmo_2</span>, 1, 16, 0, <span class="var type1" id="S16T7U98">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">    <span class="mxinfo " id="T2:U58"><span class="var type1" id="S4T2U101">Bias</span> = <span class="mxinfo " id="T2:U60">fi(<span class="var type1" id="S21T9U104">fmo_3</span>, 1, 16, 2, <span class="var type1" id="S16T7U108">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">    <span class="mxinfo " id="T3:U63"><span class="var type1" id="S5T3U111">P</span> = <span class="mxinfo " id="T3:U65">fi(<span class="var type1" id="S22T10U114">fmo_4</span>, 1, 32, 4, <span class="var type1" id="S16T7U118">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">    [<span class="mxinfo " id="T1:U68"><span class="var type1" id="S2T1U123">Theta</span>(:)</span>, <span class="mxinfo " id="T1:U70"><span class="var type1" id="S3T1U126">dTheta</span>(:)</span>, <span class="mxinfo " id="T2:U72"><span class="var type1" id="S4T2U129">Bias</span>(:)</span>, <span class="mxinfo " id="T3:U74"><span class="var type1" id="S5T3U132">P</span>(:)</span>] = <span class="fcn" id="F1179N4:B135">GyroCorrection</span>(<span class="var type1" id="S2T1U136">Theta</span>, <span class="var type1" id="S3T1U137">dTheta</span>, <span class="var type1" id="S4T2U138">Bias</span>, <span class="var type1" id="S5T3U139">P</span>, <span class="var type1" id="S10T1U140">Gyro</span>, <span class="var type1" id="S14T5U141">rw</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">    [<span class="mxinfo " id="T1:U82"><span class="var type1" id="S2T1U146">Theta</span>(:)</span>, <span class="mxinfo " id="T1:U84"><span class="var type1" id="S3T1U149">dTheta</span>(:)</span>, <span class="mxinfo " id="T2:U86"><span class="var type1" id="S4T2U152">Bias</span>(:)</span>, <span class="mxinfo " id="T3:U88"><span class="var type1" id="S5T3U155">P</span>(:)</span>] = <span class="fcn" id="F1811N3:B158">AccCorrection</span>(<span class="var type1" id="S2T1U159">Theta</span>, <span class="var type1" id="S3T1U160">dTheta</span>, <span class="var type1" id="S4T2U161">Bias</span>, <span class="var type1" id="S5T3U162">P</span>, <span class="var type1" id="S11T1U163">AccTheta</span>, <span class="var type1" id="S15T6U164">rt</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
</pre>
