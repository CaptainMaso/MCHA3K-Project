<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="8,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%                                                                          %</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%           Generated by MATLAB 9.0 and Fixed-Point Designer 5.2           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%                                                                          %</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,7" id="srcline7">  7</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T4U3">Theta</span>, <span class="var type1" id="S3T4U4">dTheta</span>, <span class="var type1" id="S4T5U5">Bias</span>, <span class="var type1" id="S5T6U6">P</span>] = IMUKalmanFilter_fixpt(<span class="var type1" id="S6T4U9">Theta_1</span>, <span class="var type1" id="S7T4U10">dTheta_1</span>, <span class="var type1" id="S8T5U11">Bias_1</span>, <span class="var type1" id="S9T6U12">P_1</span>, <span class="var type1" id="S10T4U13">Gyro</span>, <span class="var type1" id="S11T4U14">AccTheta</span>, <span class="var type1" id="S12T7U15">qw</span>, <span class="var type1" id="S13T8U16">qb</span>, <span class="var type1" id="S14T8U17">rw</span>, <span class="var type1" id="S15T9U18">rt</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="8,8" id="srcline8">  8</a></span><span class="line">    <span class="mxinfo " id="T3:U15"><span class="var type1" id="S16T221U21">fm</span> = <span class="mxinfo " id="T3:U17"><span class="fcn" id="F37N10:B23">get_fimath</span>()</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,9" id="srcline9">  9</a></span><span class="line">    <span class="mxinfo " id="T5:U18"><span class="var type1" id="S4T5U26">Bias</span> = <span class="mxinfo " id="T5:U20">fi(<span class="var type1" id="S8T5U29">Bias_1</span>, 1, 16, 2, <span class="var type1" id="S16T221U33">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,10" id="srcline10"> 10</a></span><span class="line">    <span class="mxinfo " id="T6:U23"><span class="var type1" id="S5T6U36">P</span> = <span class="mxinfo " id="T6:U25">fi(<span class="var type1" id="S9T6U39">P_1</span>, 1, 32, 4, <span class="var type1" id="S16T221U43">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T4:U28"><span class="var type1" id="S2T4U46">Theta</span> = <span class="mxinfo " id="T4:U30">fi(<span class="var type1" id="S6T4U49">Theta_1</span>, 1, 16, 0, <span class="var type1" id="S16T221U53">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T4:U33"><span class="var type1" id="S3T4U56">dTheta</span> = <span class="mxinfo " id="T4:U35">fi(<span class="var type1" id="S7T4U59">dTheta_1</span>, 1, 16, 0, <span class="var type1" id="S16T221U63">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,14" id="srcline14"> 14</a></span><span class="line">    [<span class="var type1" id="S19T10U67">fmo_1</span>, <span class="var type1" id="S20T10U68">fmo_2</span>, <span class="var type1" id="S21T13U69">fmo_3</span>, <span class="var type1" id="S22T34U70">fmo_4</span>] = <span class="fcn" id="F352N5:B72">TimeUpdate</span>(<span class="var type1" id="S2T4U73">Theta</span>, <span class="var type1" id="S3T4U74">dTheta</span>, <span class="var type1" id="S4T5U75">Bias</span>, <span class="var type1" id="S5T6U76">P</span>, <span class="var type1" id="S12T7U77">qw</span>, <span class="var type1" id="S13T8U78">qb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="8,15" id="srcline15"> 15</a></span><span class="line">    <span class="mxinfo " id="T4:U48"><span class="var type1" id="S2T4U81">Theta</span> = <span class="mxinfo " id="T4:U50">fi(<span class="var type1" id="S19T10U84">fmo_1</span>, 1, 16, 0, <span class="var type1" id="S16T221U88">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,16" id="srcline16"> 16</a></span><span class="line">    <span class="mxinfo " id="T4:U53"><span class="var type1" id="S3T4U91">dTheta</span> = <span class="mxinfo " id="T4:U55">fi(<span class="var type1" id="S20T10U94">fmo_2</span>, 1, 16, 0, <span class="var type1" id="S16T221U98">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,17" id="srcline17"> 17</a></span><span class="line">    <span class="mxinfo " id="T5:U58"><span class="var type1" id="S4T5U101">Bias</span> = <span class="mxinfo " id="T5:U60">fi(<span class="var type1" id="S21T13U104">fmo_3</span>, 1, 16, 2, <span class="var type1" id="S16T221U108">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,18" id="srcline18"> 18</a></span><span class="line">    <span class="mxinfo " id="T6:U63"><span class="var type1" id="S5T6U111">P</span> = <span class="mxinfo " id="T6:U65">fi(<span class="var type1" id="S22T34U114">fmo_4</span>, 1, 32, 4, <span class="var type1" id="S16T221U118">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,19" id="srcline19"> 19</a></span><span class="line">    [<span class="mxinfo " id="T4:U68"><span class="var type1" id="S2T4U123">Theta</span>(:)</span>, <span class="mxinfo " id="T4:U70"><span class="var type1" id="S3T4U126">dTheta</span>(:)</span>, <span class="mxinfo " id="T5:U72"><span class="var type1" id="S4T5U129">Bias</span>(:)</span>, <span class="mxinfo " id="T6:U74"><span class="var type1" id="S5T6U132">P</span>(:)</span>] = <span class="fcn" id="F1206N4:B135">GyroCorrection</span>(<span class="var type1" id="S2T4U136">Theta</span>, <span class="var type1" id="S3T4U137">dTheta</span>, <span class="var type1" id="S4T5U138">Bias</span>, <span class="var type1" id="S5T6U139">P</span>, <span class="var type1" id="S10T4U140">Gyro</span>, <span class="var type1" id="S14T8U141">rw</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="8,20" id="srcline20"> 20</a></span><span class="line">    [<span class="mxinfo " id="T4:U82"><span class="var type1" id="S2T4U146">Theta</span>(:)</span>, <span class="mxinfo " id="T4:U84"><span class="var type1" id="S3T4U149">dTheta</span>(:)</span>, <span class="mxinfo " id="T5:U86"><span class="var type1" id="S4T5U152">Bias</span>(:)</span>, <span class="mxinfo " id="T6:U88"><span class="var type1" id="S5T6U155">P</span>(:)</span>] = <span class="fcn" id="F1850N3:B158">AccCorrection</span>(<span class="var type1" id="S2T4U159">Theta</span>, <span class="var type1" id="S3T4U160">dTheta</span>, <span class="var type1" id="S4T5U161">Bias</span>, <span class="var type1" id="S5T6U162">P</span>, <span class="var type1" id="S11T4U163">AccTheta</span>, <span class="var type1" id="S15T9U164">rt</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="8,21" id="srcline21"> 21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,22" id="srcline22"> 22</a></span><span class="line"></span></span>
</pre>
