<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S27T8U167">Theta</span>, <span class="var type1" id="S28T8U168">dTheta</span>, <span class="var type1" id="S29T9U169">Bias</span>, <span class="var type1" id="S30T10U170">P</span>] = TimeUpdate(<span class="var type1" id="S31T1U173">Theta_p</span>, <span class="var type1" id="S32T1U174">dTheta_p</span>, <span class="var type1" id="S33T2U175">Bias_p</span>, <span class="var type1" id="S34T3U176">P_p</span>, <span class="var type1" id="S35T4U177">qw</span>, <span class="var type1" id="S36T5U178">qb</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">    <span class="mxinfo " id="T7:U11"><span class="var type1" id="S37T30U181">fm</span> = <span class="mxinfo " id="T7:U13"><span class="fcn" id="F2N10:B183">get_fimath</span>()</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">    <span class="keyword">global</span> <span class="var type0" id="S39T0U185">T</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    <span class="comment">% State Update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo " id="T8:U14"><span class="var type1" id="S28T8U188">dTheta</span> = <span class="mxinfo " id="T8:U16">fi(<span class="var type1" id="S32T1U191">dTheta_p</span>, 1, 16, 4, <span class="var type1" id="S37T30U195">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    <span class="mxinfo " id="T8:U19"><span class="var type1" id="S27T8U198">Theta</span>  = <span class="mxinfo " id="T8:U21">fi(<span class="mxinfo " id="T41:U22"><span class="mxinfo " id="T35:U23"><span class="var type2" id="S39T12V1U203">T</span>*<span class="var type1" id="S32T1U204">dTheta_p</span></span> + <span class="var type1" id="S31T1U205">Theta_p</span></span>, 1, 16, 4, <span class="var type1" id="S37T30U209">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    <span class="mxinfo " id="T9:U28"><span class="var type1" id="S29T9U212">Bias</span> = <span class="mxinfo " id="T9:U30">fi(<span class="var type1" id="S33T2U215">Bias_p</span>, 1, 16, 9, <span class="var type1" id="S37T30U219">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="comment">% Covariance Update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="mxinfo " id="T48:U33"><span class="var type1" id="S41T48U222">Pbb_p</span> = <span class="mxinfo " id="T48:U35">fi(<span class="mxinfo " id="T27:U36"><span class="var type1" id="S34T3U226">P_p</span>(<span class="mxinfo " id="T14:U38">3</span>,<span class="mxinfo " id="T14:U39">3</span>)</span>, 0, 16, 13, <span class="var type1" id="S37T30U232">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T9:U41"><span class="var type1" id="S42T9U235">Ptb_p</span> = <span class="mxinfo " id="T9:U43">fi(<span class="mxinfo " id="T27:U44"><span class="var type1" id="S34T3U239">P_p</span>(<span class="mxinfo " id="T14:U46">2</span>,<span class="mxinfo " id="T14:U47">3</span>)</span>, 1, 16, 9, <span class="var type1" id="S37T30U245">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo " id="T51:U49"><span class="var type1" id="S43T51U248">Ptt_p</span> = <span class="mxinfo " id="T51:U51">fi(<span class="mxinfo " id="T27:U52"><span class="var type1" id="S34T3U252">P_p</span>(<span class="mxinfo " id="T14:U54">2</span>,<span class="mxinfo " id="T14:U55">2</span>)</span>, 0, 16, 6, <span class="var type1" id="S37T30U258">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="mxinfo " id="T54:U57"><span class="var type1" id="S44T54U261">Pwb_p</span> = <span class="mxinfo " id="T54:U59">fi(<span class="mxinfo " id="T27:U60"><span class="var type1" id="S34T3U265">P_p</span>(<span class="mxinfo " id="T14:U62">1</span>,<span class="mxinfo " id="T14:U63">3</span>)</span>, 1, 16, 12, <span class="var type1" id="S37T30U271">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo " id="T57:U65"><span class="var type1" id="S45T57U274">Pwt_p</span> = <span class="mxinfo " id="T57:U67">fi(<span class="mxinfo " id="T27:U68"><span class="var type1" id="S34T3U278">P_p</span>(<span class="mxinfo " id="T14:U70">1</span>,<span class="mxinfo " id="T14:U71">2</span>)</span>, 0, 16, 10, <span class="var type1" id="S37T30U284">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="mxinfo " id="T48:U73"><span class="var type1" id="S46T48U287">Pww_p</span> = <span class="mxinfo " id="T48:U75">fi(<span class="mxinfo " id="T27:U76"><span class="var type1" id="S34T3U291">P_p</span>(<span class="mxinfo " id="T14:U78">1</span>,<span class="mxinfo " id="T14:U79">1</span>)</span>, 0, 16, 13, <span class="var type1" id="S37T30U297">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T48:U81"><span class="var type1" id="S47T48U300">Pbb</span> = <span class="mxinfo " id="T48:U83">fi(<span class="mxinfo " id="T68:U84"><span class="var type1" id="S41T48U304">Pbb_p</span> + <span class="mxinfo " id="T62:U86"><span class="var type1" id="S39T12U306">T</span>*<span class="var type1" id="S36T5U307">qb</span></span></span>, 0, 16, 13, <span class="var type1" id="S37T30U311">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T9:U90"><span class="var type1" id="S48T9U314">Ptb</span> = <span class="mxinfo " id="T9:U92">fi(<span class="mxinfo " id="T74:U93"><span class="mxinfo " id="T71:U94"><span class="var type1" id="S39T12U319">T</span>*<span class="var type1" id="S44T54U320">Pwb_p</span></span>+<span class="var type1" id="S42T9U321">Ptb_p</span></span>, 1, 16, 9, <span class="var type1" id="S37T30U325">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T51:U99"><span class="var type1" id="S49T51U328">Ptt</span> = <span class="mxinfo " id="T51:U101">fi(<span class="mxinfo " id="T117:U102"><span class="mxinfo " id="T100:U103"><span class="mxinfo " id="T91:U104"><span class="var type1" id="S43T51U334">Ptt_p</span> + <span class="mxinfo " id="T85:U106"><span class="var type1" id="S39T12U337">T</span>^2*<span class="var type1" id="S46T48U339">Pww_p</span></span></span> + <span class="mxinfo " id="T97:U109"><span class="mxinfo " id="T94:U110">fi(2*<span class="var type1" id="S39T12U345">T</span>, 0, 16, 22, <span class="var type1" id="S37T30U349">fm</span>)</span>*<span class="var type1" id="S45T57U350">Pwt_p</span></span></span> + <span class="mxinfo " id="T114:U114"><span class="mxinfo " id="T105:U115"><span class="var type1" id="S39T12U354">T</span>^3*<span class="var type1" id="S35T4U356">qw</span></span>*<span class="mxinfo " id="T111:U118">fi(1/3, 0, 16, 17, <span class="var type1" id="S37T30U365">fm</span>)</span></span></span>, 0, 16, 6, <span class="var type1" id="S37T30U369">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T54:U121"><span class="var type1" id="S50T54U372">Pwb</span> = <span class="mxinfo " id="T54:U123">fi(<span class="var type1" id="S44T54U375">Pwb_p</span>, 1, 16, 12, <span class="var type1" id="S37T30U379">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T57:U126"><span class="var type1" id="S51T57U382">Pwt</span> = <span class="mxinfo " id="T57:U128">fi(<span class="mxinfo " id="T129:U129"><span class="mxinfo " id="T123:U130"><span class="mxinfo " id="T120:U131"><span class="var type1" id="S39T12U388">T</span>*<span class="var type1" id="S46T48U389">Pww_p</span></span> + <span class="var type1" id="S45T57U390">Pwt_p</span></span> + <span class="mxinfo " id="T62:U135"><span class="mxinfo " id="T126:U136">fi(1/2*<span class="var type1" id="S39T12U399">T</span>^2, 0, 16, 32, <span class="var type1" id="S37T30U404">fm</span>)</span>*<span class="var type1" id="S35T4U405">qw</span></span></span>, 0, 16, 10, <span class="var type1" id="S37T30U409">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T48:U141"><span class="var type1" id="S52T48U412">Pww</span> = <span class="mxinfo " id="T48:U143">fi(<span class="mxinfo " id="T135:U144"><span class="var type1" id="S46T48U416">Pww_p</span> + <span class="mxinfo " id="T132:U146"><span class="var type1" id="S39T12U418">T</span>*<span class="var type1" id="S35T4U419">qw</span></span></span>, 0, 16, 13, <span class="var type1" id="S37T30U423">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo " id="T10:U150"><span class="var type1" id="S30T10U426">P</span> = <span class="mxinfo " id="T10:U152">fi(<span class="mxinfo " id="T10:U153">[<span class="mxinfo " id="T141:U154"><span class="mxinfo " id="T138:U155">fi(<span class="var type1" id="S52T48U433">Pww</span>, 1, 16, 5, <span class="var type1" id="S37T30U437">fm</span>)</span>, <span class="var type1" id="S51T57U438">Pwt</span>, <span class="var type1" id="S50T54U439">Pwb</span></span>; <span class="mxinfo " id="T141:U160"><span class="mxinfo " id="T138:U161">fi(<span class="var type1" id="S51T57U443">Pwt</span>, 1, 16, 5, <span class="var type1" id="S37T30U447">fm</span>)</span>, <span class="var type1" id="S49T51U448">Ptt</span>, <span class="var type1" id="S48T9U449">Ptb</span></span>; <span class="mxinfo " id="T142:U166"><span class="mxinfo " id="T9:U167">fi(<span class="var type1" id="S50T54U453">Pwb</span>, 1, 16, 9, <span class="var type1" id="S37T30U457">fm</span>)</span>, <span class="var type1" id="S48T9U458">Ptb</span>, <span class="var type1" id="S47T48U459">Pbb</span></span>]</span>, 1, 16, 5, <span class="var type1" id="S37T30U463">fm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
</pre>
